// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(cuid()) //cuid for unique, non-sequential IDs
  email String @unique
  password String
  name String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  projects Project[]
}

enum ProjectStatus {
  NOT_STARTED
  IN_PROGRESS
  DONE
}

model Project {
  id String @id @default(cuid()) //cuid for unique, non-sequential IDs
  projectName String
  projectDesc String?
  status ProjectStatus @default(NOT_STARTED)
  owner User @relation(fields:[ownerId], references: [id])
  ownerId String
  shareableLink String @unique @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  submissions OnboardingSubmission[]
}

model OnboardingSubmission {
  id String @id @default(cuid())
  project Project @relation(fields:[projectId], references: [id])
  projectId String
  clientName String?
  clientEmail String?
  formData Json? // Store flexible form fields as JSON
  submittedAt DateTime @default(now())
  files FileUpload[]
}

model FileUpload {
  id String @id @default(cuid())
  submission OnboardingSubmission @relation(fields:[submissionId], references: [id])
  submissionId String
  fileName String
  originalName String
  mimeType String
  size Int // File size in bytes
  storageUrl String // URL or path to stored file
  uploadedAt DateTime @default(now())
}